@using Nalam360Enterprise.UI.Core.Security
@using Syncfusion.Blazor.Buttons
@using Syncfusion.Blazor.Inputs
@using Syncfusion.Blazor.Grids
@using Syncfusion.Blazor.DropDowns
@using Syncfusion.Blazor.Navigations
@using Syncfusion.Blazor.Charts
@inject IPermissionService PermissionService
@inject IAuditService AuditService

<div class="n360-genomics-analysis">
    @if (!HasPermission)
    {
        <div class="alert alert-warning">
            <i class="fas fa-exclamation-triangle"></i> You do not have permission to access Genomics Analysis.
        </div>
        return;
    }

    <div class="genomics-header">
        <h3>
            <i class="fas fa-dna"></i> Genomics & Precision Medicine
            @if (UseRealAI)
            {
                <span class="badge bg-success ms-2">ðŸ¤– Real AI</span>
            }
        </h3>
        <p class="genomics-subtitle">AI-powered genetic analysis and personalized treatment recommendations</p>
    </div>

    <SfTab CssClass="genomics-tabs">
        <TabItems>
            <TabItem>
                <ChildContent>
                    <TabHeader Text="Variant Analysis"></TabHeader>
                </ChildContent>
                <ContentTemplate>
                    <div class="variant-panel">
                        <div class="input-section">
                            <div class="input-grid">
                                <div class="form-group">
                                    <label>Patient ID</label>
                                    <SfTextBox @bind-Value="@PatientId" Placeholder="Enter Patient ID" CssClass="genomics-input"></SfTextBox>
                                </div>

                                <div class="form-group">
                                    <label>Test Type</label>
                                    <SfDropDownList @bind-Value="@SelectedTestType" DataSource="@TestTypes" Placeholder="Select Test" CssClass="genomics-input">
                                    </SfDropDownList>
                                </div>

                                <div class="form-group">
                                    <label>Sample ID</label>
                                    <SfTextBox @bind-Value="@SampleId" Placeholder="Sample ID" CssClass="genomics-input"></SfTextBox>
                                </div>

                                <div class="form-group">
                                    <label>Clinical Indication</label>
                                    <SfTextBox @bind-Value="@ClinicalIndication" Placeholder="e.g., Family history of cancer" CssClass="genomics-input"></SfTextBox>
                                </div>
                            </div>

                            <SfButton CssClass="e-success analyze-btn" OnClick="AnalyzeGenomics" Disabled="@IsAnalyzing">
                                <i class="fas fa-dna"></i> @(IsAnalyzing ? "Analyzing Genomic Data..." : "Start Genomic Analysis")
                            </SfButton>
                        </div>

                        @if (CurrentAnalysis != null)
                        {
                            <div class="analysis-results">
                                <div class="result-summary">
                                    <div class="summary-card pathogenic">
                                        <i class="fas fa-exclamation-circle"></i>
                                        <div>
                                            <div class="summary-label">Pathogenic</div>
                                            <div class="summary-value">@CurrentAnalysis.Variants.Count(v => v.Classification == "Pathogenic")</div>
                                        </div>
                                    </div>
                                    <div class="summary-card likely-pathogenic">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        <div>
                                            <div class="summary-label">Likely Pathogenic</div>
                                            <div class="summary-value">@CurrentAnalysis.Variants.Count(v => v.Classification == "Likely Pathogenic")</div>
                                        </div>
                                    </div>
                                    <div class="summary-card vus">
                                        <i class="fas fa-question-circle"></i>
                                        <div>
                                            <div class="summary-label">VUS</div>
                                            <div class="summary-value">@CurrentAnalysis.Variants.Count(v => v.Classification == "VUS")</div>
                                        </div>
                                    </div>
                                    <div class="summary-card benign">
                                        <i class="fas fa-check-circle"></i>
                                        <div>
                                            <div class="summary-label">Benign</div>
                                            <div class="summary-value">@CurrentAnalysis.Variants.Count(v => v.Classification == "Benign")</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="variants-section">
                                    <h4><i class="fas fa-list"></i> Detected Variants</h4>
                                    <SfGrid DataSource="@CurrentAnalysis.Variants" AllowSorting="true" AllowFiltering="true" AllowPaging="true">
                                        <GridPageSettings PageSize="10"></GridPageSettings>
                                        <GridColumns>
                                            <GridColumn Field="@nameof(GeneticVariant.Gene)" HeaderText="Gene" Width="100"></GridColumn>
                                            <GridColumn Field="@nameof(GeneticVariant.Variant)" HeaderText="Variant" Width="150"></GridColumn>
                                            <GridColumn Field="@nameof(GeneticVariant.Classification)" HeaderText="Classification" Width="140">
                                                <Template>
                                                    @{
                                                        var variant = (context as GeneticVariant)!;
                                                        <span class="classification-badge class-@variant.Classification.Replace(" ", "-").ToLower()">
                                                            @variant.Classification
                                                        </span>
                                                    }
                                                </Template>
                                            </GridColumn>
                                            <GridColumn Field="@nameof(GeneticVariant.Zygosity)" HeaderText="Zygosity" Width="120"></GridColumn>
                                            <GridColumn Field="@nameof(GeneticVariant.AlleleFrequency)" HeaderText="Allele Freq" Width="120"></GridColumn>
                                            <GridColumn Field="@nameof(GeneticVariant.ClinicalSignificance)" HeaderText="Clinical Impact" Width="180"></GridColumn>
                                            <GridColumn HeaderText="Actions" Width="120">
                                                <Template>
                                                    <SfButton CssClass="e-small e-info" IconCss="fas fa-info-circle">Details</SfButton>
                                                </Template>
                                            </GridColumn>
                                        </GridColumns>
                                    </SfGrid>
                                </div>

                                <div class="disease-associations">
                                    <h4><i class="fas fa-heartbeat"></i> Disease Associations</h4>
                                    <div class="disease-grid">
                                        @foreach (var disease in CurrentAnalysis.DiseaseRisks)
                                        {
                                            <div class="disease-card risk-@disease.RiskLevel.ToLower()">
                                                <div class="disease-header">
                                                    <h5>@disease.DiseaseName</h5>
                                                    <span class="risk-badge risk-@disease.RiskLevel.ToLower()">@disease.RiskLevel Risk</span>
                                                </div>
                                                <div class="disease-info">
                                                    <div class="info-row">
                                                        <span>Relative Risk:</span>
                                                        <strong>@disease.RelativeRisk</strong>
                                                    </div>
                                                    <div class="info-row">
                                                        <span>Lifetime Risk:</span>
                                                        <strong>@disease.LifetimeRisk</strong>
                                                    </div>
                                                    <div class="info-row">
                                                        <span>Associated Genes:</span>
                                                        <strong>@string.Join(", ", disease.AssociatedGenes)</strong>
                                                    </div>
                                                </div>
                                                <div class="disease-recommendation">
                                                    <i class="fas fa-clipboard-check"></i> @disease.Recommendation
                                                </div>
                                            </div>
                                        }
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </ContentTemplate>
            </TabItem>

            <TabItem>
                <ChildContent>
                    <TabHeader Text="Pharmacogenomics"></TabHeader>
                </ChildContent>
                <ContentTemplate>
                    <div class="pharma-panel">
                        @if (CurrentAnalysis?.PharmacogenomicProfile != null)
                        {
                            <div class="pharma-summary">
                                <h4><i class="fas fa-pills"></i> Pharmacogenomic Profile</h4>
                                <p class="pharma-description">Genetic variants affecting drug metabolism and response</p>
                            </div>

                            <div class="drug-recommendations">
                                @foreach (var drug in CurrentAnalysis.PharmacogenomicProfile.DrugRecommendations)
                                {
                                    <div class="drug-card recommendation-@drug.Recommendation.Replace(" ", "-").ToLower()">
                                        <div class="drug-header">
                                            <div>
                                                <h5>@drug.DrugName</h5>
                                                <span class="drug-category">@drug.Category</span>
                                            </div>
                                            <span class="recommendation-badge rec-@drug.Recommendation.Replace(" ", "-").ToLower()">
                                                @drug.Recommendation
                                            </span>
                                        </div>
                                        <div class="drug-info">
                                            <div class="info-item">
                                                <label>Genotype:</label>
                                                <span>@drug.Genotype</span>
                                            </div>
                                            <div class="info-item">
                                                <label>Metabolizer Status:</label>
                                                <span class="metabolizer-@drug.MetabolizerStatus.Replace(" ", "-").ToLower()">@drug.MetabolizerStatus</span>
                                            </div>
                                            <div class="info-item">
                                                <label>Evidence Level:</label>
                                                <span>@drug.EvidenceLevel</span>
                                            </div>
                                        </div>
                                        <div class="drug-guidance">
                                            <strong>Clinical Guidance:</strong>
                                            <p>@drug.ClinicalGuidance</p>
                                        </div>
                                        <div class="drug-alternative">
                                            @if (!string.IsNullOrEmpty(drug.AlternativeDrug))
                                            {
                                                <i class="fas fa-exchange-alt"></i>
                                                <span>Consider: @drug.AlternativeDrug</span>
                                            }
                                        </div>
                                    </div>
                                }
                            </div>

                            <div class="enzyme-panel">
                                <h4><i class="fas fa-flask"></i> Drug Metabolizing Enzymes</h4>
                                <div class="enzyme-grid">
                                    @foreach (var enzyme in CurrentAnalysis.PharmacogenomicProfile.EnzymeActivity)
                                    {
                                        <div class="enzyme-card">
                                            <div class="enzyme-name">@enzyme.Key</div>
                                            <div class="enzyme-activity activity-@enzyme.Value.Replace(" ", "-").ToLower()">
                                                @enzyme.Value
                                            </div>
                                            <div class="enzyme-description">
                                                @GetEnzymeDescription(enzyme.Key)
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="empty-state">
                                <i class="fas fa-pills"></i>
                                <p>Run variant analysis to see pharmacogenomic recommendations.</p>
                            </div>
                        }
                    </div>
                </ContentTemplate>
            </TabItem>

            <TabItem>
                <ChildContent>
                    <TabHeader Text="Cancer Genomics"></TabHeader>
                </ChildContent>
                <ContentTemplate>
                    <div class="cancer-panel">
                        @if (CurrentAnalysis?.CancerGenomics != null)
                        {
                            <div class="cancer-overview">
                                <div class="cancer-stat-card">
                                    <div class="stat-icon"><i class="fas fa-dna"></i></div>
                                    <div>
                                        <div class="stat-value">@CurrentAnalysis.CancerGenomics.SomaticMutations</div>
                                        <div class="stat-label">Somatic Mutations</div>
                                    </div>
                                </div>
                                <div class="cancer-stat-card">
                                    <div class="stat-icon"><i class="fas fa-bullseye"></i></div>
                                    <div>
                                        <div class="stat-value">@CurrentAnalysis.CancerGenomics.ActionableMutations</div>
                                        <div class="stat-label">Actionable Targets</div>
                                    </div>
                                </div>
                                <div class="cancer-stat-card">
                                    <div class="stat-icon"><i class="fas fa-syringe"></i></div>
                                    <div>
                                        <div class="stat-value">@CurrentAnalysis.CancerGenomics.TherapeuticOptions</div>
                                        <div class="stat-label">Treatment Options</div>
                                    </div>
                                </div>
                                <div class="cancer-stat-card">
                                    <div class="stat-icon"><i class="fas fa-flask"></i></div>
                                    <div>
                                        <div class="stat-value">@CurrentAnalysis.CancerGenomics.ClinicalTrials</div>
                                        <div class="stat-label">Matching Trials</div>
                                    </div>
                                </div>
                            </div>

                            <div class="biomarkers-section">
                                <h4><i class="fas fa-microscope"></i> Tumor Biomarkers</h4>
                                <div class="biomarkers-grid">
                                    @foreach (var biomarker in CurrentAnalysis.CancerGenomics.Biomarkers)
                                    {
                                        <div class="biomarker-card status-@biomarker.Status.ToLower()">
                                            <div class="biomarker-header">
                                                <span class="biomarker-name">@biomarker.BiomarkerName</span>
                                                <span class="biomarker-status status-@biomarker.Status.ToLower()">@biomarker.Status</span>
                                            </div>
                                            <div class="biomarker-details">
                                                <div class="detail-item">
                                                    <label>Type:</label>
                                                    <span>@biomarker.Type</span>
                                                </div>
                                                <div class="detail-item">
                                                    <label>Value:</label>
                                                    <span>@biomarker.Value</span>
                                                </div>
                                            </div>
                                            <div class="biomarker-implication">
                                                <strong>Clinical Implication:</strong>
                                                <p>@biomarker.ClinicalImplication</p>
                                            </div>
                                            @if (!string.IsNullOrEmpty(biomarker.TargetedTherapy))
                                            {
                                                <div class="targeted-therapy">
                                                    <i class="fas fa-crosshairs"></i> <strong>Targeted Therapy:</strong> @biomarker.TargetedTherapy
                                                </div>
                                            }
                                        </div>
                                    }
                                </div>
                            </div>

                            <div class="treatment-recommendations">
                                <h4><i class="fas fa-prescription"></i> Precision Therapy Recommendations</h4>
                                <div class="therapy-list">
                                    @foreach (var therapy in CurrentAnalysis.CancerGenomics.TherapyRecommendations)
                                    {
                                        <div class="therapy-card evidence-@therapy.EvidenceLevel.Replace(" ", "-").ToLower()">
                                            <div class="therapy-header">
                                                <h5>@therapy.TherapyName</h5>
                                                <span class="evidence-badge">@therapy.EvidenceLevel</span>
                                            </div>
                                            <div class="therapy-target">
                                                <strong>Target:</strong> @therapy.Target
                                            </div>
                                            <div class="therapy-rationale">
                                                <strong>Rationale:</strong> @therapy.Rationale
                                            </div>
                                            <div class="therapy-response">
                                                <label>Expected Response:</label>
                                                <span class="response-rate">@therapy.ExpectedResponse</span>
                                            </div>
                                            <div class="therapy-trials">
                                                <i class="fas fa-vial"></i> @therapy.ClinicalTrials available clinical trials
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="empty-state">
                                <i class="fas fa-dna"></i>
                                <p>Run variant analysis with cancer indication to see oncogenomic results.</p>
                            </div>
                        }
                    </div>
                </ContentTemplate>
            </TabItem>

            <TabItem>
                <ChildContent>
                    <TabHeader Text="Ancestry & Traits"></TabHeader>
                </ChildContent>
                <ContentTemplate>
                    <div class="ancestry-panel">
                        @if (CurrentAnalysis?.AncestryProfile != null)
                        {
                            <div class="ancestry-composition">
                                <h4><i class="fas fa-globe"></i> Ancestry Composition</h4>
                                <div class="ancestry-chart">
                                    <SfAccumulationChart>
                                        <AccumulationChartSeriesCollection>
                                            <AccumulationChartSeries DataSource="@CurrentAnalysis.AncestryProfile.Composition"
                                                                    XName="Region"
                                                                    YName="Percentage"
                                                                    Type="AccumulationType.Pie">
                                                <AccumulationDataLabelSettings Visible="true" Name="Region" Position="AccumulationLabelPosition.Outside">
                                                </AccumulationDataLabelSettings>
                                            </AccumulationChartSeries>
                                        </AccumulationChartSeriesCollection>
                                    </SfAccumulationChart>
                                </div>
                                <div class="ancestry-breakdown">
                                    @foreach (var ancestry in CurrentAnalysis.AncestryProfile.Composition)
                                    {
                                        <div class="ancestry-item">
                                            <span class="ancestry-region">@ancestry.Region</span>
                                            <div class="ancestry-bar-container">
                                                <div class="ancestry-bar" style="width: @($"{ancestry.Percentage}%")"></div>
                                            </div>
                                            <span class="ancestry-percentage">@($"{ancestry.Percentage:F1}%")</span>
                                        </div>
                                    }
                                </div>
                            </div>

                            <div class="traits-section">
                                <h4><i class="fas fa-user"></i> Genetic Traits</h4>
                                <div class="traits-grid">
                                    @foreach (var trait in CurrentAnalysis.AncestryProfile.Traits)
                                    {
                                        <div class="trait-card">
                                            <div class="trait-icon">
                                                <i class="@trait.IconClass"></i>
                                            </div>
                                            <div class="trait-content">
                                                <h5>@trait.TraitName</h5>
                                                <div class="trait-result">@trait.Result</div>
                                                <div class="trait-confidence">@($"{trait.Confidence:F0}%") confidence</div>
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>

                            <div class="haplogroups-section">
                                <h4><i class="fas fa-sitemap"></i> Haplogroups</h4>
                                <div class="haplogroup-cards">
                                    <div class="haplogroup-card">
                                        <h5>Paternal Lineage</h5>
                                        <div class="haplogroup-name">@CurrentAnalysis.AncestryProfile.PaternalHaplogroup</div>
                                        <p>Y-DNA haplogroup representing paternal ancestry</p>
                                    </div>
                                    <div class="haplogroup-card">
                                        <h5>Maternal Lineage</h5>
                                        <div class="haplogroup-name">@CurrentAnalysis.AncestryProfile.MaternalHaplogroup</div>
                                        <p>mtDNA haplogroup representing maternal ancestry</p>
                                    </div>
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="empty-state">
                                <i class="fas fa-globe"></i>
                                <p>Run variant analysis to see ancestry and traits information.</p>
                            </div>
                        }
                    </div>
                </ContentTemplate>
            </TabItem>

            <TabItem>
                <ChildContent>
                    <TabHeader Text="Reports & Export"></TabHeader>
                </ChildContent>
                <ContentTemplate>
                    <div class="reports-panel">
                        @if (CurrentAnalysis != null)
                        {
                            <div class="report-options">
                                <h4><i class="fas fa-file-medical"></i> Generate Clinical Report</h4>
                                <div class="report-types">
                                    <div class="report-type-card">
                                        <i class="fas fa-file-pdf"></i>
                                        <h5>Comprehensive Report</h5>
                                        <p>Full genomic analysis with all variants, disease risks, and recommendations</p>
                                        <SfButton CssClass="e-primary">Generate PDF</SfButton>
                                    </div>
                                    <div class="report-type-card">
                                        <i class="fas fa-pills"></i>
                                        <h5>Pharmacogenomic Report</h5>
                                        <p>Drug-gene interactions and dosing recommendations</p>
                                        <SfButton CssClass="e-primary">Generate PDF</SfButton>
                                    </div>
                                    <div class="report-type-card">
                                        <i class="fas fa-dna"></i>
                                        <h5>Oncogenomic Report</h5>
                                        <p>Cancer-specific mutations and targeted therapy options</p>
                                        <SfButton CssClass="e-primary">Generate PDF</SfButton>
                                    </div>
                                    <div class="report-type-card">
                                        <i class="fas fa-user"></i>
                                        <h5>Patient Summary</h5>
                                        <p>Patient-friendly report with key findings and recommendations</p>
                                        <SfButton CssClass="e-primary">Generate PDF</SfButton>
                                    </div>
                                </div>
                            </div>

                            <div class="export-options">
                                <h4><i class="fas fa-download"></i> Export Data</h4>
                                <div class="export-buttons">
                                    <SfButton CssClass="e-outline" IconCss="fas fa-file-csv">Export to VCF</SfButton>
                                    <SfButton CssClass="e-outline" IconCss="fas fa-file-excel">Export to Excel</SfButton>
                                    <SfButton CssClass="e-outline" IconCss="fas fa-file-code">Export to JSON</SfButton>
                                    <SfButton CssClass="e-outline" IconCss="fas fa-database">Send to Database</SfButton>
                                </div>
                            </div>

                            <div class="report-summary-preview">
                                <h4><i class="fas fa-eye"></i> Report Preview</h4>
                                <div class="preview-content">
                                    <div class="preview-header">
                                        <h3>Genomic Analysis Report</h3>
                                        <div class="report-meta">
                                            <div><strong>Patient:</strong> @PatientId</div>
                                            <div><strong>Test Type:</strong> @SelectedTestType</div>
                                            <div><strong>Date:</strong> @DateTime.Now.ToString("MMMM dd, yyyy")</div>
                                        </div>
                                    </div>
                                    <div class="preview-section">
                                        <h4>SUMMARY OF FINDINGS</h4>
                                        <ul>
                                            <li>@CurrentAnalysis.Variants.Count(v => v.Classification == "Pathogenic") pathogenic variant(s) detected</li>
                                            <li>@CurrentAnalysis.DiseaseRisks.Count disease risk assessments</li>
                                            <li>@CurrentAnalysis.PharmacogenomicProfile.DrugRecommendations.Count pharmacogenomic recommendations</li>
                                            @if (CurrentAnalysis.CancerGenomics != null)
                                            {
                                                <li>@CurrentAnalysis.CancerGenomics.ActionableMutations actionable cancer mutations identified</li>
                                            }
                                        </ul>
                                    </div>
                                    <div class="preview-section">
                                        <h4>CLINICAL RECOMMENDATIONS</h4>
                                        <p>Based on the genetic findings, the following clinical actions are recommended:</p>
                                        <ol>
                                            @foreach (var risk in CurrentAnalysis.DiseaseRisks.Take(3))
                                            {
                                                <li>@risk.Recommendation</li>
                                            }
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="empty-state">
                                <i class="fas fa-file-medical"></i>
                                <p>Run genomic analysis to generate reports.</p>
                            </div>
                        }
                    </div>
                </ContentTemplate>
            </TabItem>
        </TabItems>
    </SfTab>
</div>

<style>
    .n360-genomics-analysis {
        padding: 20px;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .genomics-header {
        margin-bottom: 30px;
    }

    .genomics-header h3 {
        color: #2c3e50;
        font-size: 28px;
        margin-bottom: 8px;
    }

    .genomics-header h3 i {
        color: #8e44ad;
        margin-right: 10px;
    }

    .genomics-subtitle {
        color: #7f8c8d;
        font-size: 14px;
        margin: 0;
    }

    .genomics-tabs {
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .variant-panel, .pharma-panel, .cancer-panel, .ancestry-panel, .reports-panel {
        padding: 20px;
    }

    .input-section {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
    }

    .input-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
    }

    .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: 600;
        color: #2c3e50;
        font-size: 13px;
    }

    .analyze-btn {
        width: 100%;
        height: 44px;
        font-size: 15px;
    }

    .result-summary {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 30px;
    }

    .summary-card {
        padding: 20px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        gap: 15px;
        color: white;
    }

    .summary-card i {
        font-size: 32px;
    }

    .summary-card.pathogenic {
        background: linear-gradient(135deg, #e74c3c, #c0392b);
    }

    .summary-card.likely-pathogenic {
        background: linear-gradient(135deg, #f39c12, #e67e22);
    }

    .summary-card.vus {
        background: linear-gradient(135deg, #3498db, #2980b9);
    }

    .summary-card.benign {
        background: linear-gradient(135deg, #27ae60, #229954);
    }

    .summary-label {
        font-size: 12px;
        opacity: 0.9;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .summary-value {
        font-size: 28px;
        font-weight: bold;
    }

    .variants-section, .disease-associations {
        margin-bottom: 30px;
    }

    .variants-section h4, .disease-associations h4 {
        margin-bottom: 20px;
        color: #2c3e50;
        font-size: 18px;
    }

    .classification-badge {
        padding: 5px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        color: white;
    }

    .classification-badge.class-pathogenic {
        background: #e74c3c;
    }

    .classification-badge.class-likely-pathogenic {
        background: #f39c12;
    }

    .classification-badge.class-vus {
        background: #3498db;
    }

    .classification-badge.class-benign, .classification-badge.class-likely-benign {
        background: #27ae60;
    }

    .disease-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: 20px;
    }

    .disease-card {
        background: white;
        border: 2px solid;
        border-radius: 8px;
        padding: 20px;
    }

    .disease-card.risk-high {
        border-color: #e74c3c;
        background: #ffebee;
    }

    .disease-card.risk-moderate {
        border-color: #f39c12;
        background: #fff8e1;
    }

    .disease-card.risk-low {
        border-color: #3498db;
        background: #e3f2fd;
    }

    .disease-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }

    .disease-header h5 {
        margin: 0;
        color: #2c3e50;
        font-size: 16px;
    }

    .risk-badge {
        padding: 5px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        color: white;
    }

    .risk-badge.risk-high {
        background: #e74c3c;
    }

    .risk-badge.risk-moderate {
        background: #f39c12;
    }

    .risk-badge.risk-low {
        background: #3498db;
    }

    .disease-info {
        margin-bottom: 15px;
    }

    .info-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        font-size: 14px;
    }

    .disease-recommendation {
        padding: 12px;
        background: rgba(52, 152, 219, 0.1);
        border-radius: 4px;
        font-size: 13px;
        color: #2c3e50;
    }

    .disease-recommendation i {
        color: #3498db;
        margin-right: 8px;
    }

    .pharma-summary {
        margin-bottom: 30px;
    }

    .pharma-summary h4 {
        margin: 0 0 8px 0;
        color: #2c3e50;
        font-size: 20px;
    }

    .pharma-description {
        color: #7f8c8d;
        margin: 0;
    }

    .drug-recommendations {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin-bottom: 30px;
    }

    .drug-card {
        background: white;
        border: 2px solid #ecf0f1;
        border-left-width: 6px;
        border-radius: 8px;
        padding: 20px;
    }

    .drug-card.recommendation-use-standard-dose {
        border-left-color: #27ae60;
    }

    .drug-card.recommendation-use-with-caution {
        border-left-color: #f39c12;
    }

    .drug-card.recommendation-consider-alternative {
        border-left-color: #e74c3c;
    }

    .drug-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 15px;
    }

    .drug-header h5 {
        margin: 0 0 5px 0;
        color: #2c3e50;
        font-size: 18px;
    }

    .drug-category {
        color: #7f8c8d;
        font-size: 13px;
    }

    .recommendation-badge {
        padding: 6px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        color: white;
    }

    .recommendation-badge.rec-use-standard-dose {
        background: #27ae60;
    }

    .recommendation-badge.rec-use-with-caution {
        background: #f39c12;
    }

    .recommendation-badge.rec-consider-alternative {
        background: #e74c3c;
    }

    .drug-info {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 15px;
    }

    .info-item {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }

    .info-item label {
        font-size: 12px;
        color: #7f8c8d;
        font-weight: 600;
    }

    .info-item span {
        font-size: 14px;
        color: #2c3e50;
        font-weight: 600;
    }

    .drug-guidance {
        margin-bottom: 12px;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 4px;
        font-size: 14px;
    }

    .drug-guidance p {
        margin: 5px 0 0 0;
        line-height: 1.5;
    }

    .drug-alternative {
        color: #3498db;
        font-size: 14px;
        font-weight: 600;
    }

    .drug-alternative i {
        margin-right: 8px;
    }

    .enzyme-panel {
        margin-top: 30px;
    }

    .enzyme-panel h4 {
        margin-bottom: 20px;
        color: #2c3e50;
        font-size: 18px;
    }

    .enzyme-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 15px;
    }

    .enzyme-card {
        background: white;
        border: 2px solid #ecf0f1;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
    }

    .enzyme-name {
        font-size: 16px;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 12px;
    }

    .enzyme-activity {
        padding: 8px 16px;
        border-radius: 12px;
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 12px;
        display: inline-block;
    }

    .enzyme-activity.activity-normal-metabolizer {
        background: #27ae60;
        color: white;
    }

    .enzyme-activity.activity-rapid-metabolizer {
        background: #f39c12;
        color: white;
    }

    .enzyme-activity.activity-poor-metabolizer {
        background: #e74c3c;
        color: white;
    }

    .enzyme-activity.activity-intermediate-metabolizer {
        background: #3498db;
        color: white;
    }

    .enzyme-description {
        font-size: 13px;
        color: #7f8c8d;
        line-height: 1.4;
    }

    .cancer-overview {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .cancer-stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 25px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        gap: 20px;
    }

    .stat-icon {
        width: 60px;
        height: 60px;
        background: rgba(255,255,255,0.2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 28px;
    }

    .stat-value {
        font-size: 32px;
        font-weight: bold;
    }

    .stat-label {
        font-size: 14px;
        opacity: 0.9;
    }

    .biomarkers-section, .treatment-recommendations {
        margin-bottom: 30px;
    }

    .biomarkers-section h4, .treatment-recommendations h4 {
        margin-bottom: 20px;
        color: #2c3e50;
        font-size: 18px;
    }

    .biomarkers-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
    }

    .biomarker-card {
        background: white;
        border: 2px solid #ecf0f1;
        border-radius: 8px;
        padding: 20px;
    }

    .biomarker-card.status-positive {
        border-color: #e74c3c;
        background: #ffebee;
    }

    .biomarker-card.status-negative {
        border-color: #27ae60;
        background: #eafaf1;
    }

    .biomarker-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }

    .biomarker-name {
        font-weight: 600;
        font-size: 16px;
        color: #2c3e50;
    }

    .biomarker-status {
        padding: 5px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        color: white;
    }

    .biomarker-status.status-positive {
        background: #e74c3c;
    }

    .biomarker-status.status-negative {
        background: #27ae60;
    }

    .biomarker-details {
        display: flex;
        gap: 20px;
        margin-bottom: 12px;
    }

    .detail-item {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }

    .detail-item label {
        font-size: 12px;
        color: #7f8c8d;
        font-weight: 600;
    }

    .detail-item span {
        font-size: 14px;
        color: #2c3e50;
    }

    .biomarker-implication {
        margin-bottom: 12px;
        padding: 12px;
        background: rgba(52, 152, 219, 0.1);
        border-radius: 4px;
        font-size: 13px;
    }

    .biomarker-implication p {
        margin: 5px 0 0 0;
    }

    .targeted-therapy {
        padding: 10px;
        background: #e3f2fd;
        border-radius: 4px;
        font-size: 13px;
        color: #2c3e50;
    }

    .therapy-list {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .therapy-card {
        background: white;
        border: 2px solid #ecf0f1;
        border-radius: 8px;
        padding: 20px;
    }

    .therapy-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
    }

    .therapy-header h5 {
        margin: 0;
        color: #2c3e50;
        font-size: 16px;
    }

    .evidence-badge {
        padding: 5px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
        background: #3498db;
        color: white;
    }

    .therapy-target, .therapy-rationale {
        margin-bottom: 10px;
        font-size: 14px;
    }

    .therapy-response {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 4px;
    }

    .response-rate {
        font-weight: 600;
        color: #27ae60;
    }

    .therapy-trials {
        color: #3498db;
        font-size: 13px;
        font-weight: 600;
    }

    .ancestry-composition {
        margin-bottom: 40px;
    }

    .ancestry-composition h4 {
        margin-bottom: 20px;
        color: #2c3e50;
        font-size: 18px;
    }

    .ancestry-chart {
        margin-bottom: 30px;
        text-align: center;
    }

    .ancestry-breakdown {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .ancestry-item {
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .ancestry-region {
        min-width: 150px;
        font-weight: 600;
        color: #2c3e50;
    }

    .ancestry-bar-container {
        flex: 1;
        height: 30px;
        background: #ecf0f1;
        border-radius: 4px;
        overflow: hidden;
    }

    .ancestry-bar {
        height: 100%;
        background: linear-gradient(90deg, #3498db, #2980b9);
        transition: width 0.5s;
    }

    .ancestry-percentage {
        min-width: 60px;
        text-align: right;
        font-weight: 600;
        color: #3498db;
    }

    .traits-section, .haplogroups-section {
        margin-bottom: 40px;
    }

    .traits-section h4, .haplogroups-section h4 {
        margin-bottom: 20px;
        color: #2c3e50;
        font-size: 18px;
    }

    .traits-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
    }

    .trait-card {
        background: white;
        border: 2px solid #ecf0f1;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
    }

    .trait-icon {
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #667eea, #764ba2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 28px;
        color: white;
        margin: 0 auto 15px;
    }

    .trait-content h5 {
        margin: 0 0 8px 0;
        color: #2c3e50;
        font-size: 14px;
    }

    .trait-result {
        font-size: 16px;
        font-weight: 600;
        color: #3498db;
        margin-bottom: 5px;
    }

    .trait-confidence {
        font-size: 12px;
        color: #7f8c8d;
    }

    .haplogroup-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
    }

    .haplogroup-card {
        background: white;
        border: 2px solid #ecf0f1;
        border-radius: 8px;
        padding: 25px;
        text-align: center;
    }

    .haplogroup-card h5 {
        margin: 0 0 15px 0;
        color: #2c3e50;
        font-size: 16px;
    }

    .haplogroup-name {
        font-size: 32px;
        font-weight: bold;
        color: #8e44ad;
        margin-bottom: 10px;
    }

    .haplogroup-card p {
        margin: 0;
        color: #7f8c8d;
        font-size: 13px;
    }

    .report-options, .export-options {
        margin-bottom: 40px;
    }

    .report-options h4, .export-options h4 {
        margin-bottom: 20px;
        color: #2c3e50;
        font-size: 18px;
    }

    .report-types {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
    }

    .report-type-card {
        background: white;
        border: 2px solid #ecf0f1;
        border-radius: 8px;
        padding: 25px;
        text-align: center;
    }

    .report-type-card i {
        font-size: 48px;
        color: #3498db;
        margin-bottom: 15px;
    }

    .report-type-card h5 {
        margin: 0 0 10px 0;
        color: #2c3e50;
        font-size: 16px;
    }

    .report-type-card p {
        margin: 0 0 15px 0;
        color: #7f8c8d;
        font-size: 13px;
        line-height: 1.5;
    }

    .export-buttons {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
    }

    .report-summary-preview {
        margin-top: 40px;
    }

    .report-summary-preview h4 {
        margin-bottom: 20px;
        color: #2c3e50;
        font-size: 18px;
    }

    .preview-content {
        background: white;
        border: 2px solid #ecf0f1;
        border-radius: 8px;
        padding: 30px;
    }

    .preview-header {
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid #ecf0f1;
    }

    .preview-header h3 {
        margin: 0 0 15px 0;
        color: #2c3e50;
        font-size: 24px;
    }

    .report-meta {
        display: flex;
        gap: 30px;
        font-size: 14px;
        color: #7f8c8d;
    }

    .preview-section {
        margin-bottom: 25px;
    }

    .preview-section h4 {
        margin: 0 0 12px 0;
        color: #2c3e50;
        font-size: 14px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .preview-section ul, .preview-section ol {
        margin: 0;
        padding-left: 25px;
        line-height: 1.8;
    }

    .preview-section p {
        margin: 0 0 10px 0;
        line-height: 1.6;
    }

    .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #95a5a6;
    }

    .empty-state i {
        font-size: 64px;
        margin-bottom: 20px;
        opacity: 0.5;
    }

    .alert {
        padding: 15px 20px;
        border-radius: 8px;
        margin-bottom: 20px;
    }

    .alert-warning {
        background: #fff3cd;
        border: 1px solid #ffc107;
        color: #856404;
    }
</style>
